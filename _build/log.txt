; Shows a simple modal message box to the right of the main GUI
CustomMsgBoxToRight(Text, Title:="Message", Seconds:=3) {
    global GuiHwnd
    WinGetPos, gx, gy, gw, gh, ahk_id %GuiHwnd%
    if (gx = "")  ; Could not get window
        gx := 0, gy := 0, gw := 400, gh := 200

    ; Set dimensions
    w := 300, h := 120
    ; Place to the right with a margin, vertically aligned
    mx := gx + gw + 20
    my := gy + 20

    ; Create a unique Gui
    Gui, +OwnDialogs
    Gui, MsgBoxGui:New, , %Title%
    Gui, MsgBoxGui:Add, Text, xm ym w%w% r3, %Text%
    Gui, MsgBoxGui:Add, Button, gMsgBoxGuiClose Default xm w100, OK
    Gui, MsgBoxGui:Show, x%mx% y%my% w%w% h%h%, %Title%

    ; Auto-close after timeout, if given
    if (Seconds > 0)
    {
        SetTimer, MsgBoxGui_Close, -% (Seconds*1000)
    }
    Return

    MsgBoxGuiClose:
    MsgBoxGui_Close:
        Gui, MsgBoxGui:Destroy
    Return
}

